FROM python:3.10-slim

# Avoid interactive prompts and ensure UTF-8
# ENV PYTHONDONTWRITEBYTECODE=1
# ENV PYTHONUNBUFFERED=1
# ENV HF_HOME="/inFILE/.cache"

# Set workdir and copy everything
WORKDIR /inFILE
COPY . /inFILE

# Upgrade pip and install dependencies efficiently
RUN pip install --no-cache-dir --upgrade pip \
 && pip install --no-cache-dir -r requirements.txt

# Expose port explicitly (good for clarity)
EXPOSE 7860

# Start FastAPI server
CMD ["uvicorn", "app:app", "--host", "0.0.0.0", "--port", "7860"]
